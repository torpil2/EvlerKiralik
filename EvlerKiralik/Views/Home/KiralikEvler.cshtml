@using EvlerKiralik.DAL.Entities
@using Microsoft.AspNetCore.Http
@using System.Security.Claims


<meta name="viewport" content="width=device-width, initial-scale=1.0" />

@model dynamic
@{
    ViewData["Title"] = "KiralikEvler";
    //Layout = "~/Views/Shared/_HomePageLayout.cshtml";
}



<script>
    var filterbutton = document.getElementById("filter");
    var filterform = document.getElementById("filterform");
    function showhideform()
    {

            if(filterform.style.visibility=="visible") {
            filterform.className = "";
            filterform.className = "animate__animated animate__fadeOutDown";

           
            setTimeout(() => { filterform.style.visibility = "hidden"; }, 500);
                          
            console.log(" visible " + filterform);

            }
            else if(filterform.style.visibility=="hidden")
            {
           

                filterform.style.visibility="visible";
            filterform.className="animate__animated animate__fadeInUp";
            console.log(" hidden "+filterform);

            }
        }
    
</script>

<script>
    $(function () {
        $('#ilan1').change(function () {
            var id = $('#ilan1').val();
            console.log(id);
            $.ajax({
                url: '/Home/ilcegetirilan',
                data: { a: id },
                type: "POST",
                dataType: "Json",
                success: function (data) {

                    console.log(data);
                    $('#ilan2').empty();
                    $('#ilan2').append("<option> </option>");

                    for (var i = 0; i < data.length; i++) {
                        $('#ilan2').append("<option value='" + data[i].value + "'>" + data[i].text + "</option>");
                    }
                }
            });
        });
    });
</script>

<script>
    $(function () {
        $('#ilan2').change(function () {
            var id = $('#ilan2').val();
            $.ajax({
                url: '/Home/mahallegetirilan',
                data: { b: id },
                type: "POST",
                dataType: "Json",
                success: function (data) {

                    console.log(data);
                    $('#ilan3').empty();
                    $('#ilan3').append("<option> </option>");

                    for (var i = 0; i < data.length; i++) {
                        $('#ilan3').append("<option value='" + data[i].value + "'>" + data[i].text + "</option>");
                    }
                }
            });
        });
    });
</script>
<script>
    $(function () {
        $('#ilan3').change(function () {
            var id = $('#ilan3').val();
            $.ajax({
                url: '/Home/sokakgetirilan',
                data: { c: id },
                type: "POST",
                dataType: "Json",
                success: function (data) {

                    console.log(data);
                    $('#ilan4').empty();
                  
                      $('#ilan4').append("<option> </option>");
                    for (var i = 0; i < data.length; i++) {
                        $('#ilan4').append("<option value='" + data[i].value + "'>" + data[i].text + "</option>");
                    }
                }
            });
        });
    });
</script>

<script>
    $("#ilan1").change( function () {
        var search = $("#ilan1 option:selected").text();
        console.log("function calisti= " +search );
        $("#posts").show().filter(function () {
           
            return $("#posts").text().indexOf(search) < 0;
          
        }).hide();

    });
    //DÜZENELENECEK
</script>
    
    <div style="position:fixed;z-index:999;right:-5%;top:15%;">
        <button id="filter" title="Filtrele" onclick="showhideform()"> <i class="fa-solid fa-filter fa-2xl" style=""></i> </button>
        <form id="filterform" class="" style="background-color:grey;border-radius:10px;visibility:hidden;margin:1em;padding:1em;;" method="post">

            <select name="ilanil" id="ilan1" class="search2 form-control form-control-sm">
                <option selected">İl Seçiniz</option>

                @foreach (Iller ililan in Model.IlListesiIlan)
                {

                    <option title="@ililan.IlId" id="@ililan.IlId" value="@ililan.IlId" title="@ililan.İlAdi">@ililan.İlAdi </option>
                }
            </select>
            <label class="fieldlabels">İlan İLçce: *</label>    <select id="ilan2" name="ilanilce" class="search2 form-control form-control-sm">
                <option selected">İlçe Seçiniz</option>
            </select>
            <label class="fieldlabels"> İlan Mahalle: *</label>  <select name="ilanmahalle" id="ilan3" class="search2 form-control form-control-sm">
                <option selected">Mahalle Seçiniz</option>
            </select>
            <label class="fieldlabels"> İlan Sokak: *</label>    <select name="ilansokak" id="ilan4" class="search2 form-control form-control-sm">
                <option selected">Sokak Seçiniz</option>
            </select>


            <select class="form-control">
                <option>as</option>
               
            </select>

                 <input class="form-control" type="submit" value="Filtrele" />
            
            </form>
        
    
    
    </div>

<div id="animateloadingdiv">


    <ul class="cards">

        @foreach (KirayaVerme post in Model.KiralikEv)
        {
            <li id="posts">
                <a class="card" href="/Home/IlanDetay/@post.IlanId" name="ilanId">

            <i id="likebutton"   class="fa-solid fa-heart fa-2xl" style="position:absolute;right:20px;top:40px;  text-shadow: -1px 0 black, 0 1px black, 1px 0 black, 0 -1px black;cursor:pointer;"></i>
@*            <img  href="/Home/Privacy" src="https://i.imgur.com/oYiTqum.jpg" class="card__image" alt="" />

*@                  @*  <div id="cardyazi" style="position: absolute;display: flex; flex-direction: column;justify-content: flex-end; background: linear-gradient(to top, rgba(0, 0, 0, 0.70), transparent);top:5%;left:5%;color:;">
                        <p style=" user-select: none; ">Günlük</p>
                    </div>*@
                     @foreach (Picture pic in Model.PictureList)
                    {
                        @if(pic.PostId==post.IlanId && pic.IsKapak==true)
                         {
                                var resim = pic.ResimName.ToString();

                            <img  class="card__image" alt="" src="/imgs/@resim" />
                        }
                           else
                         {
                        

                         }
                    }
                        
                  

            <div class="card__overlay" href="">
            
                <div class="card__header" >
                    <svg class="card__arc" xmlns="http://www.w3.org/2000/svg"><path /></svg>
                    <div class="card__header-text">
                        <h3 class="card__title">@post.IlanAdi</h3>
                        <span class="card__tagline">
                            <ul id="menu">
                            <li><i class="fa-solid fa-location-crosshairs"></i> @post.IlanIl / @post.IlanIlce  </li>
                                <li><i class="fa-solid fa-house-chimney-window"></i> @post.OdaSayisi </li>
                                <li><i class="fa-solid fa-money-bill-wave"></i> @post.KiraTutari</li>
                        </ul> </span>
                        <span class="card__status">@post.IlanDate.Value.GetDateTimeFormats()[4]</span>
                 </div>
            </div>
                        <p class="card__description">
                            <i class="fa-solid fa-house-fire" title="Isınma Türü"></i> @post.IsitmaTuru | 

                            <i class="fa-solid fa-table" title="Minimum Kiralama Süresi"></i> @post.MinimumSure 3 ay |

                          
                            @if (post.Esyali == "Eşyalı")
                          
                            {
                                <i class="fa-solid fa-couch"></i>

                                @post.Esyali
                            }
                        
                                <i class="fa-solid fa-vector-square" title="Net m²"></i> @post.M2Net 15 m² |



                            <i class="fa-solid fa-building" title="Bulunduğu Kat"></i> @post.BulunduguKat
                         
                        </p>
                    </div>
        </a>
    </li>
        }

  

     

</ul>
</div>

